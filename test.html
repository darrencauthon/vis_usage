<html>
    <head>
        <script type="text/javascript" src="vis.js"></script>
    </head>
    <body>

    <div id="mynetwork"></div>

    <script type="text/javascript">

            var data = [
	      {
	          "sentence": "The Justice Department's internal watchdog has sent a criminal referral for fired FBI official Andrew McCabe to the U.S. attorney's office in Washington.", 
		      "tree": {
		            "ROOT": [
			            {
				              "index": 8, 
					                "token": "sent", 
							          "label": "VERB", 
								            "pos": "VBN", 
									              "tree": {
										                  "nsubj": [
												                {
														                "index": 6, 
																                "token": "watchdog", 
																		                "label": "NOUN", 
																				                "pos": "NN", 
																						                "tree": {
																								                  "poss": [
																										                      {
																												                            "index": 3, 
																															                          "token": "Department", 
																																		                        "label": "NOUN", 
																																					                      "pos": "NNP", 
																																							                            "tree": {
																																										                            "det": [
																																													                              {
																																																                                  "index": 1, 
																																																				                              "token": "The", 
																																																							                                  "label": "DET", 
																																																											                              "pos": "DT"
																																																														                                }
																																																																		                        ], 
																																																																					                        "nn": [
																																																																								                          {
																																																																											                              "index": 2, 
																																																																														                                  "token": "Justice", 
																																																																																		                              "label": "NOUN", 
																																																																																					                                  "pos": "NNP"
																																																																																									                            }
																																																																																												                            ], 
																																																																																															                            "possessive": [
																																																																																																		                              {
																																																																																																					                                  "index": 4, 
																																																																																																									                              "token": "'s", 
																																																																																																												                                  "label": "PRT", 
																																																																																																																                              "pos": "POS"
																																																																																																																			                                }
																																																																																																																							                        ]
																																																																																																																										                      }
																																																																																																																												                          }
																																																																																																																															                    ], 
																																																																																																																																	                      "amod": [
																																																																																																																																			                          {
																																																																																																																																						                        "index": 5, 
																																																																																																																																									                      "token": "internal", 
																																																																																																																																											                            "label": "ADJ", 
																																																																																																																																														                          "pos": "JJ"
																																																																																																																																																	                      }
																																																																																																																																																			                        ]
																																																																																																																																																						                }
																																																																																																																																																								              }
																																																																																																																																																									                  ], 
																																																																																																																																																											              "aux": [
																																																																																																																																																												                    {
																																																																																																																																																														                    "index": 7, 
																																																																																																																																																																                    "token": "has", 
																																																																																																																																																																		                    "label": "VERB", 
																																																																																																																																																																				                    "pos": "VBZ"
																																																																																																																																																																						                  }
																																																																																																																																																																								              ], 
																																																																																																																																																																									                  "dobj": [
																																																																																																																																																																											                {
																																																																																																																																																																													                "index": 11, 
																																																																																																																																																																															                "token": "referral", 
																																																																																																																																																																																	                "label": "NOUN", 
																																																																																																																																																																																			                "pos": "NN", 
																																																																																																																																																																																					                "tree": {
																																																																																																																																																																																							                  "det": [
																																																																																																																																																																																									                      {
																																																																																																																																																																																											                            "index": 9, 
																																																																																																																																																																																														                          "token": "a", 
																																																																																																																																																																																																	                        "label": "DET", 
																																																																																																																																																																																																				                      "pos": "DT"
																																																																																																																																																																																																						                          }
																																																																																																																																																																																																									                    ], 
																																																																																																																																																																																																											                      "amod": [
																																																																																																																																																																																																													                          {
																																																																																																																																																																																																																                        "index": 10, 
																																																																																																																																																																																																																			                      "token": "criminal", 
																																																																																																																																																																																																																					                            "label": "ADJ", 
																																																																																																																																																																																																																								                          "pos": "JJ"
																																																																																																																																																																																																																											                      }
																																																																																																																																																																																																																													                        ], 
																																																																																																																																																																																																																																                  "prep": [
																																																																																																																																																																																																																																		                      {
																																																																																																																																																																																																																																				                            "index": 12, 
																																																																																																																																																																																																																																							                          "token": "for", 
																																																																																																																																																																																																																																										                        "label": "ADP", 
																																																																																																																																																																																																																																													                      "pos": "IN", 
																																																																																																																																																																																																																																															                            "tree": {
																																																																																																																																																																																																																																																		                            "pobj": [
																																																																																																																																																																																																																																																					                              {
																																																																																																																																																																																																																																																								                                  "index": 17, 
																																																																																																																																																																																																																																																												                              "token": "McCabe", 
																																																																																																																																																																																																																																																															                                  "label": "NOUN", 
																																																																																																																																																																																																																																																																			                              "pos": "NNP", 
																																																																																																																																																																																																																																																																						                                  "tree": {
																																																																																																																																																																																																																																																																										                                "nn": [
																																																																																																																																																																																																																																																																														                                {
																																																																																																																																																																																																																																																																																		                                  "index": 15, 
																																																																																																																																																																																																																																																																																						                                    "token": "official", 
																																																																																																																																																																																																																																																																																										                                      "label": "ADJ", 
																																																																																																																																																																																																																																																																																														                                        "pos": "JJ", 
																																																																																																																																																																																																																																																																																																			                                  "tree": {
																																																																																																																																																																																																																																																																																																							                                      "amod": [
																																																																																																																																																																																																																																																																																																											                                            {
																																																																																																																																																																																																																																																																																																																                                            "index": 13, 
																																																																																																																																																																																																																																																																																																																					                                            "token": "fired", 
																																																																																																																																																																																																																																																																																																																										                                            "label": "VERB", 
																																																																																																																																																																																																																																																																																																																															                                            "pos": "VBN"
																																																																																																																																																																																																																																																																																																																																				                                          }
																																																																																																																																																																																																																																																																																																																																									                                      ], 
																																																																																																																																																																																																																																																																																																																																													                                          "nn": [
																																																																																																																																																																																																																																																																																																																																																		                                        {
																																																																																																																																																																																																																																																																																																																																																							                                        "index": 14, 
																																																																																																																																																																																																																																																																																																																																																												                                        "token": "FBI", 
																																																																																																																																																																																																																																																																																																																																																																	                                        "label": "NOUN", 
																																																																																																																																																																																																																																																																																																																																																																						                                        "pos": "NNP"
																																																																																																																																																																																																																																																																																																																																																																											                                      }
																																																																																																																																																																																																																																																																																																																																																																															                                          ]
																																																																																																																																																																																																																																																																																																																																																																																				                                    }
																																																																																																																																																																																																																																																																																																																																																																																								                                    }, 
																																																																																																																																																																																																																																																																																																																																																																																												                                    {
																																																																																																																																																																																																																																																																																																																																																																																																                                      "index": 16, 
																																																																																																																																																																																																																																																																																																																																																																																																				                                        "token": "Andrew", 
																																																																																																																																																																																																																																																																																																																																																																																																									                                  "label": "NOUN", 
																																																																																																																																																																																																																																																																																																																																																																																																													                                    "pos": "NNP"
																																																																																																																																																																																																																																																																																																																																																																																																																	                                    }
																																																																																																																																																																																																																																																																																																																																																																																																																					                                  ]
																																																																																																																																																																																																																																																																																																																																																																																																																									                              }
																																																																																																																																																																																																																																																																																																																																																																																																																												                                }
																																																																																																																																																																																																																																																																																																																																																																																																																																                        ]
																																																																																																																																																																																																																																																																																																																																																																																																																																			                      }
																																																																																																																																																																																																																																																																																																																																																																																																																																					                          }
																																																																																																																																																																																																																																																																																																																																																																																																																																								                    ]
																																																																																																																																																																																																																																																																																																																																																																																																																																										                    }
																																																																																																																																																																																																																																																																																																																																																																																																																																												                  }
																																																																																																																																																																																																																																																																																																																																																																																																																																														              ], 
																																																																																																																																																																																																																																																																																																																																																																																																																																															                  "prep": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																	                {
																																																																																																																																																																																																																																																																																																																																																																																																																																																			                "index": 18, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																					                "token": "to", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																							                "label": "ADP", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																									                "pos": "IN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																											                "tree": {
																																																																																																																																																																																																																																																																																																																																																																																																																																																													                  "pobj": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																															                      {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																	                            "index": 23, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																				                          "token": "office", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																							                        "label": "NOUN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																										                      "pos": "NN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                            "tree": {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																															                            "poss": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		                              {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					                                  "index": 21, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									                              "token": "attorney", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                                  "label": "NOUN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																                              "pos": "NN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			                                  "tree": {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							                                "det": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											                                {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															                                  "index": 19, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			                                    "token": "the", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							                                      "label": "DET", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											                                        "pos": "DT"
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																                                }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				                              ], 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							                                    "nn": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																											                                    {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															                                      "index": 20, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			                                        "token": "U.S.", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								                                  "label": "NOUN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                                    "pos": "NNP"
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																                                    }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				                                  ], 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								                                "possessive": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                                {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																                                  "index": 22, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				                                    "token": "'s", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								                                      "label": "PRT", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                                        "pos": "POS"
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	                                }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					                              ]
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								                                  }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                            }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															                            ], 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		                            "prep": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																					                              {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								                                  "index": 24, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                              "token": "in", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															                                  "label": "ADP", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			                              "pos": "IN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						                                  "tree": {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										                                "pobj": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														                                {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		                                  "index": 25, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						                                    "token": "Washington", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										                                      "label": "NOUN", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														                                        "pos": "NNP"
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			                                }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							                              ]
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										                                  }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														                            }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	                            ]
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				                          }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																							                      }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																									                        ]
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														              }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															                  ], 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	              "punct": [
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		                    {
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																				                    "index": 26, 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																						                    "token": ".", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																								                    "label": ".", 
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																										                    "pos": "."
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																												                  }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																														              ]
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																															                }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																	        }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		      ]
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																		          }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			    }
																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																																			    ];




var parse = function(data){
    var results = [];
    for(var key in data)
    {
        var value = data[key];

	if (typeof(value) == 'object')
	{
            var theseResults = parse(value);
	    value.children = [];
	    for(var i = 0; i < theseResults.length; i++){
	        results.push(theseResults[i]);
		if (theseResults[i].parent == undefined)
                    theseResults[i].parent = value.index > 0 ? value : null;
	        value.children.push(theseResults[i]);
	    }
	    if (value.index != undefined){
		results.push(value);
	    }
        }
	else if (Array.isArray(value))
	    for(var i = 0; i < value.length; i++)
	    {
	        var theseResults = parse(value[index]);
	        for(var i = 0; i < theseResults.length; i++){
	            results.push(theseResults[i]);
	        }
            }
    }
    return results;
};

var data = data[0];
var results = parse(data);


for(var i = 0; i < results.length; i++)
{
    var sortedChildren = [results[i]];
    for(var j = 0; j < results[i].children.length; j++){sortedChildren.push(results[i].children[j])};
    sortedChildren = sortedChildren.sort(function(a, b){ return a.index - b.index });
    results[i].phrase = '';
    for (var j = 0; j < sortedChildren.length; j++){
        results[i].phrase = results[i].phrase + ' ' + sortedChildren[j].token;
    }
    results[i].phrase = results[i].phrase.trim();
}

for(var i = 0; i < results.length; i++)
{
    results[i].directChildren = [];
    for(var j = 0; j < results[i].children.length; j++)
    {
        if (results[i].children[j].parent != undefined)
	    if (results[i].children[j].parent.index == results[i].index)
	        results[i].directChildren.push(results[i].children[j]);
    }
}

console.log(results);

            // create an array with nodes
            var nodes = new vis.DataSet([]);
            for(var i = 0; i < results.length; i++)
                nodes.add({id: results[i].index, label: results[i].token});

            // create an array with edges
            var edges = new vis.DataSet([]);
            for(var i = 0; i < results.length; i++)
	        if (results[i].parent != undefined)
                    edges.add({from: results[i].parent.index, to: results[i].index});

            // create a network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            var options = {};
            var network = new vis.Network(container, data, options);

        </script>
    </body>
</html>
