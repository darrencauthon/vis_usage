<html>
    <head>
        <script type="text/javascript" src="vis.js"></script>
    </head>
    <body>

    <div id="mynetwork"></div>

    <script type="text/javascript">

            var data = [   {     "sentence": "In his memos documenting conversations with President Donald Trump, former FBI Director James Comey recounts Trump's \"serious reservations\" about then-national security adviser Michael Flynn as well as the President's concerns about media leaks and Trump's recollection of Russian President Vladimir Putin telling him that Russia had the \"most beautiful hookers in the world.\"",      "tree": {       "ROOT": [         {           "index": 16,            "token": "recounts",            "label": "VERB",            "pos": "VBZ",            "tree": {             "prep": [               {                 "index": 1,                  "token": "In",                  "label": "ADP",                  "pos": "IN",                  "tree": {                   "pobj": [                     {                       "index": 3,                        "token": "memos",                        "label": "NOUN",                        "pos": "NNS",                        "tree": {                         "poss": [                           {                             "index": 2,                              "token": "his",                              "label": "PRON",                              "pos": "PRP$"                           }                         ],                          "partmod": [                           {                             "index": 4,                              "token": "documenting",                              "label": "VERB",                              "pos": "VBG",                              "tree": {                               "dobj": [                                 {                                   "index": 5,                                    "token": "conversations",                                    "label": "NOUN",                                    "pos": "NNS",                                    "tree": {                                     "prep": [                                       {                                         "index": 6,                                          "token": "with",                                          "label": "ADP",                                          "pos": "IN",                                          "tree": {                                           "pobj": [                                             {                                               "index": 9,                                                "token": "Trump",                                                "label": "NOUN",                                                "pos": "NNP",                                                "tree": {                                                 "nn": [                                                   {                                                     "index": 7,                                                      "token": "President",                                                      "label": "NOUN",                                                      "pos": "NNP"                                                   },                                                    {                                                     "index": 8,                                                      "token": "Donald",                                                      "label": "NOUN",                                                      "pos": "NNP"                                                   }                                                 ]                                               }                                             }                                           ]                                         }                                       }                                     ]                                   }                                 }                               ]                             }                           }                         ]                       }                     }                   ]                 }               }             ],              "punct": [               {                 "index": 10,                  "token": ",",                  "label": ".",                  "pos": ","               },                {                 "index": 61,                  "token": ".",                  "label": ".",                  "pos": "."               },                {                 "index": 62,                  "token": "''",                  "label": ".",                  "pos": "''"               }             ],              "nsubj": [               {                 "index": 15,                  "token": "Comey",                  "label": "NOUN",                  "pos": "NNP",                  "tree": {                   "nn": [                     {                       "index": 13,                        "token": "Director",                        "label": "NOUN",                        "pos": "NNP",                        "tree": {                         "amod": [                           {                             "index": 11,                              "token": "former",                              "label": "ADJ",                              "pos": "JJ"                           }                         ],                          "nn": [                           {                             "index": 12,                              "token": "FBI",                              "label": "NOUN",                              "pos": "NNP"                           }                         ]                       }                     },                      {                       "index": 14,                        "token": "James",                        "label": "NOUN",                        "pos": "NNP"                     }                   ]                 }               }             ],              "dobj": [               {                 "index": 21,                  "token": "reservations",                  "label": "NOUN",                  "pos": "NNS",                  "tree": {                   "poss": [                     {                       "index": 17,                        "token": "Trump",                        "label": "NOUN",                        "pos": "NNP",                        "tree": {                         "possessive": [                           {                             "index": 18,                              "token": "'s",                              "label": "PRT",                              "pos": "POS"                           }                         ]                       }                     }                   ],                    "punct": [                     {                       "index": 19,                        "token": "``",                        "label": ".",                        "pos": "``"                     },                      {                       "index": 22,                        "token": "''",                        "label": ".",                        "pos": "''"                     }                   ],                    "amod": [                     {                       "index": 20,                        "token": "serious",                        "label": "ADJ",                        "pos": "JJ"                     }                   ],                    "prep": [                     {                       "index": 23,                        "token": "about",                        "label": "ADP",                        "pos": "IN",                        "tree": {                         "pobj": [                           {                             "index": 28,                              "token": "Flynn",                              "label": "NOUN",                              "pos": "NNP",                              "tree": {                               "nn": [                                 {                                   "index": 26,                                    "token": "adviser",                                    "label": "NOUN",                                    "pos": "NN",                                    "tree": {                                     "amod": [                                       {                                         "index": 24,                                          "token": "then-national",                                          "label": "ADJ",                                          "pos": "JJ"                                       }                                     ],                                      "nn": [                                       {                                         "index": 25,                                          "token": "security",                                          "label": "NOUN",                                          "pos": "NN"                                       }                                     ]                                   }                                 },                                  {                                   "index": 27,                                    "token": "Michael",                                    "label": "NOUN",                                    "pos": "NNP"                                 }                               ],                                "cc": [                                 {                                   "index": 30,                                    "token": "well",                                    "label": "ADV",                                    "pos": "RB",                                    "tree": {                                     "advmod": [                                       {                                         "index": 29,                                          "token": "as",                                          "label": "ADV",                                          "pos": "RB"                                       }                                     ],                                      "mwe": [                                       {                                         "index": 31,                                          "token": "as",                                          "label": "ADP",                                          "pos": "IN"                                       }                                     ]                                   }                                 }                               ],                                "conj": [                                 {                                   "index": 35,                                    "token": "concerns",                                    "label": "NOUN",                                    "pos": "NNS",                                    "tree": {                                     "poss": [                                       {                                         "index": 33,                                          "token": "President",                                          "label": "NOUN",                                          "pos": "NNP",                                          "tree": {                                           "det": [                                             {                                               "index": 32,                                                "token": "the",                                                "label": "DET",                                                "pos": "DT"                                             }                                           ],                                            "possessive": [                                             {                                               "index": 34,                                                "token": "'s",                                                "label": "PRT",                                                "pos": "POS"                                             }                                           ]                                         }                                       }                                     ],                                      "prep": [                                       {                                         "index": 36,                                          "token": "about",                                          "label": "ADP",                                          "pos": "IN",                                          "tree": {                                           "pobj": [                                             {                                               "index": 38,                                                "token": "leaks",                                                "label": "NOUN",                                                "pos": "NNS",                                                "tree": {                                                 "nn": [                                                   {                                                     "index": 37,                                                      "token": "media",                                                      "label": "NOUN",                                                      "pos": "NNS"                                                   }                                                 ]                                               }                                             }                                           ]                                         }                                       }                                     ],                                      "cc": [                                       {                                         "index": 39,                                          "token": "and",                                          "label": "CONJ",                                          "pos": "CC"                                       }                                     ],                                      "conj": [                                       {                                         "index": 42,                                          "token": "recollection",                                          "label": "NOUN",                                          "pos": "NN",                                          "tree": {                                           "poss": [                                             {                                               "index": 40,                                                "token": "Trump",                                                "label": "NOUN",                                                "pos": "NNP",                                                "tree": {                                                 "possessive": [                                                   {                                                     "index": 41,                                                      "token": "'s",                                                      "label": "PRT",                                                      "pos": "POS"                                                   }                                                 ]                                               }                                             }                                           ],                                            "prep": [                                             {                                               "index": 43,                                                "token": "of",                                                "label": "ADP",                                                "pos": "IN",                                                "tree": {                                                 "pcomp": [                                                   {                                                     "index": 48,                                                      "token": "telling",                                                      "label": "VERB",                                                      "pos": "VBG",                                                      "tree": {                                                       "nsubj": [                                                         {                                                           "index": 47,                                                            "token": "Putin",                                                            "label": "NOUN",                                                            "pos": "NNP",                                                            "tree": {                                                             "nn": [                                                               {                                                                 "index": 45,                                                                  "token": "President",                                                                  "label": "NOUN",                                                                  "pos": "NNP",                                                                  "tree": {                                                                   "amod": [                                                                     {                                                                       "index": 44,                                                                        "token": "Russian",                                                                        "label": "ADJ",                                                                        "pos": "JJ"                                                                     }                                                                   ]                                                                 }                                                               },                                                                {                                                                 "index": 46,                                                                  "token": "Vladimir",                                                                  "label": "NOUN",                                                                  "pos": "NNP"                                                               }                                                             ]                                                           }                                                         }                                                       ],                                                        "dobj": [                                                         {                                                           "index": 49,                                                            "token": "him",                                                            "label": "PRON",                                                            "pos": "PRP"                                                         }                                                       ],                                                        "ccomp": [                                                         {                                                           "index": 52,                                                            "token": "had",                                                            "label": "VERB",                                                            "pos": "VBD",                                                            "tree": {                                                             "mark": [                                                               {                                                                 "index": 50,                                                                  "token": "that",                                                                  "label": "ADP",                                                                  "pos": "IN"                                                               }                                                             ],                                                              "nsubj": [                                                               {                                                                 "index": 51,                                                                  "token": "Russia",                                                                  "label": "NOUN",                                                                  "pos": "NNP"                                                               }                                                             ],                                                              "dobj": [                                                               {                                                                 "index": 57,                                                                  "token": "hookers",                                                                  "label": "NOUN",                                                                  "pos": "NNS",                                                                  "tree": {                                                                   "det": [                                                                     {                                                                       "index": 53,                                                                        "token": "the",                                                                        "label": "DET",                                                                        "pos": "DT"                                                                     }                                                                   ],                                                                    "punct": [                                                                     {                                                                       "index": 54,                                                                        "token": "``",                                                                        "label": ".",                                                                        "pos": "``"                                                                     }                                                                   ],                                                                    "amod": [                                                                     {                                                                       "index": 56,                                                                        "token": "beautiful",                                                                        "label": "ADJ",                                                                        "pos": "JJ",                                                                        "tree": {                                                                         "advmod": [                                                                           {                                                                             "index": 55,                                                                              "token": "most",                                                                              "label": "ADV",                                                                              "pos": "RBS"                                                                           }                                                                         ]                                                                       }                                                                     }                                                                   ],                                                                    "prep": [                                                                     {                                                                       "index": 58,                                                                        "token": "in",                                                                        "label": "ADP",                                                                        "pos": "IN",                                                                        "tree": {                                                                         "pobj": [                                                                           {                                                                             "index": 60,                                                                              "token": "world",                                                                              "label": "NOUN",                                                                              "pos": "NN",                                                                              "tree": {                                                                               "det": [                                                                                 {                                                                                   "index": 59,                                                                                    "token": "the",                                                                                    "label": "DET",                                                                                    "pos": "DT"                                                                                 }                                                                               ]                                                                             }                                                                           }                                                                         ]                                                                       }                                                                     }                                                                   ]                                                                 }                                                               }                                                             ]                                                           }                                                         }                                                       ]                                                     }                                                   }                                                 ]                                               }                                             }                                           ]                                         }                                       }                                     ]                                   }                                 }                               ]                             }                           }                         ]                       }                     }                   ]                 }               }             ]           }         }       ]     }   } ];




var parse = function(data){
    var results = [];
    for(var key in data)
    {
        var value = data[key];

	if (typeof(value) == 'object')
	{
            var theseResults = parse(value);
	    value.children = [];
	    for(var i = 0; i < theseResults.length; i++){
	        results.push(theseResults[i]);
		if (theseResults[i].parent == undefined)
                    theseResults[i].parent = value.index > 0 ? value : null;
	        value.children.push(theseResults[i]);
	    }
	    if (value.index != undefined){
		results.push(value);
	    }
        }
	else if (Array.isArray(value))
	    for(var i = 0; i < value.length; i++)
	    {
	        var theseResults = parse(value[index]);
	        for(var i = 0; i < theseResults.length; i++){
	            results.push(theseResults[i]);
	        }
            }
    }
    return results;
};

var data = data[0];
var results = parse(data);


for(var i = 0; i < results.length; i++)
{
    var sortedChildren = [results[i]];
    for(var j = 0; j < results[i].children.length; j++){sortedChildren.push(results[i].children[j])};
    sortedChildren = sortedChildren.sort(function(a, b){ return a.index - b.index });
    results[i].phrase = '';
    for (var j = 0; j < sortedChildren.length; j++){
        results[i].phrase = results[i].phrase + ' ' + sortedChildren[j].token;
    }
    results[i].phrase = results[i].phrase.trim();
}

for(var i = 0; i < results.length; i++)
{
    results[i].directChildren = [];
    for(var j = 0; j < results[i].children.length; j++)
    {
        if (results[i].children[j].parent != undefined)
	    if (results[i].children[j].parent.index == results[i].index)
	        results[i].directChildren.push(results[i].children[j]);
    }
}

console.log(results);

            // create an array with nodes
            var nodes = new vis.DataSet([]);
            for(var i = 0; i < results.length; i++)
                nodes.add({id: results[i].index, label: results[i].token});

            // create an array with edges
            var edges = new vis.DataSet([]);
            for(var i = 0; i < results.length; i++)
	        if (results[i].parent != undefined)
                    edges.add({from: results[i].parent.index, to: results[i].index});

            // create a network
            var container = document.getElementById('mynetwork');
            var data = {
                nodes: nodes,
                edges: edges
            };
            var options = {};
            var network = new vis.Network(container, data, options);

        </script>
    </body>
</html>
